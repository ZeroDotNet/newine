<script type="text/template" id='wines-template'>
	<div class='row'>
		<div class='col-lg-10 col-offset-2'>
			<a href="/wines/{{id}}" class=''>
				<div class='panel panel-default panel-link'>
					<div class='panel-body'>
						
							<img src='/assets/img/bottle-icon.png' width=50 height=50 />
						
							<span style="padding-left:10px;">									
								<strong>{{id}}:</strong> {{name}} - {{variety}} - {{vintage}}										
							</span>						
					</div>
				</div>
			</a>
		</div>
	</div>
</script>
<script src='/assets/js/newine.js'></script>
<script src='/assets/js/wines_index.js'></script>
<div class='container'>
	<div class='row'>
		<div class='col-lg-12'>
			<div class='row'>
				<div class='col-lg-12 col-xs-12 centered'><h2>Vinos</h2></div>
			</div>
			<div class='row'>
				<div class='col-lg-12 col-xs-12 new-dispenser-button centered' style='vertical-align:middle;margin-top:20px;'>
					<a class='btn btn-success' id='new_wine_btn'>Nuevo Vino</a>
				</div>
			</div>
			<div class='row' style='padding-bottom:10px;'>
				<div class='col-lg-12 col-sm-12 col-xs-12 no-padding'>
					<form class='form-search form-inline' action='/wines' method='get'>
						<div class='col-lg-3 col-md-3 col-sm-8 col-xs-8  col-lg-offset-0 col-md-offset-0 col-xs-offset-1 col-sm-offset-1 no-padding'>
							<input type='search' name='q' class='form-control input-sm' value=<%= params[:q]%>>
						</div>
						<div class='col-lg-1 col-md-1 col-sm-2 col-xs-2 centered'>
							<button class='btn btn-search wine-search-button'>Buscar</button>
						</div>
					</form>
				</div>
			</div>
			
		</div>
	</div>
	<div class='row'>
		<div class='col-lg-4 col-md-4 col-sm-12'>
			<div class='row'>
				<div class='col-lg-12  apple_pagination'>
					<%= will_paginate @wines %>
				</div>
			</div>
			<div class='row'>

				<div id='wines-container'>
					<% @wines.each do |wine| %>
						<div class='row'>
							<div class='col-lg-10 col-lg-offset-1 col-sm-10 col-sm-offset-1 col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1'>
								
								<div class='panel panel-default panel-link wine-link' data-id=<%= wine.id.to_s %>>
									<div class='panel-body'>
										
										<img src='/assets/img/bottle-icon.png' width=40 height=40 />
									
										<span style="padding-left:10px;">									
											<strong><%= wine.id %>:</strong> <%= wine.name %> <%= wine.variety %> <%= wine.vintage %>									
										</span>						
									</div>
								</div>
							
							</div>
						</div>
					<% end %>

				</div>
			</div>
		</div>
		<div class='col-lg-offset-1 col-lg-7 col-md-offset-1 col-md-7 col-sm-12 col-xs-12'>
			
			<div id='wine-details-container'>
					<% @wines.each do |wine| %>
						<div class='row wine-data hidden' data-wine-id=<%= wine.id.to_s %>>
							<div class='col-lg-10 col-lg-offset-1 col-sm-10 col-sm-offset-1 col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1 no-padding'>
								
								<div class='panel panel-default' style='min-height: 300px;'>
									<div class='panel-body' style='margin:10px;'>
											
											<div class='row'>
										
												<span style="padding-left:10px;">									
													<strong><%= wine.id %>:</strong> <%= wine.name %> <%= wine.variety %> <%= wine.vintage %>
													<a class='edit_wine btn btn-warning pull-right' data-wine-id=<%= wine.id.to_s %>>Editar</a>
												</span>
												<hr />
												<div class='wine_info' data-wine-id=<%= wine.id.to_s %>>
													<p style="padding-left:10px;">									
														<strong>Bodega/Marca:</strong> <%= wine.brand %>
													</p>
													<br />
													<p style="padding-left:10px;">									
														<strong>Variedad:</strong> <%= wine.variety %>
													</p>
													<br />
													<p style="padding-left:10px;">									
														<strong>Volumen:</strong> <%= wine.volume.to_s %> ml
													</p>
													<br />
													<p style="padding-left:10px;">									
														<strong>Costo botella:</strong> $<%= wine.bottle_cost.to_s %>
													</p>
													<br />
													<p style="padding-left:10px;">									
														<strong>Botella abierta (d&iacute;as):</strong> <%= wine.open_days %>
													</p>
													<br />
									
													<p style="padding-left:10px;">									
													 <%= wine.tasting_notes %>
													</p>
													<br />				


												</div>
											</div>
											<div class='row'>
												<div class='col-lg-6 col-lg-offset-3' style='padding-left: 5px; padding-right: 5px;'>
													<table class='table table-striped wine_info' data-wine-id=<%= wine.id.to_s %>>
														<thead>
															<tr>
																<th>Medida (ml)</th>
																<th>Precio ($)</th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td><%= wine.serving_volume_low %></td>
																<td><%= wine.serving_price_low %></td>
															</tr>
															<tr>
																<td><%= wine.serving_volume_med %></td>
																<td><%= wine.serving_price_med %></td>
															</tr>
															<tr>
																<td><%= wine.serving_volume_high %></td>
																<td><%= wine.serving_price_high %></td>
															</tr>

														</tbody>
													</table>
													
												</div>
											</div>
											
											<form style='padding-bottom:20px;' class='form-horizontal wine_edit_form hidden' data-wine-id=<%= wine.id.to_s %> action='/wines/edit/<%= wine.id.to_s %>' method='post'>
													<%= erb :"wines/form", locals: {wine: wine} %>
									        <div class='col-lg-offset-3' style='padding-top:20px;'>
														<button class='btn btn-primary'>Guardar</button>
														<a class='btn btn-default cancel_edit'>Cancelar</a>
													</div>
											</form>
											

									</div>
								</div>
							
							</div>
						</div>
					<% end %>

				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="new-wine-modal">
	<div class="modal-dialog">
		<div class="modal-content">
			<form action='/wines' method='post' class='form-horizontal'>
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title">Nuevo Vino</h4>
				</div>
				<div class="modal-body">
					<%= erb :"wines/form", locals: {wine: Wine.new} %>
				</div>

				<div class='modal-footer'>
					<a href="#" class="btn btn-default" data-dismiss="modal">Cancelar</a>
          			<button class='btn btn-primary'>Crear</button>
				</div>
			</form>
		</div>
	</div>
</div>

<div class="modal fade" id="new_variety_modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action='/variety' method='post' class='form-horizontal' id="form_variety">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title">Nueva variedad</h4>
                </div>
                <div class="modal-body">
                	<div class="form-group">
        						<label for='variety[name]' class='col-lg-3 control-label'>Nombre</label>
					        	<div class='col-lg-6'>
                    	<input type="text" class='form-control' name="variety[name]" required/>
					        	</div>
        					</div>
                </div>

                <div class='modal-footer'>
                    <a href="#" class="btn btn-default" data-dismiss="modal">Cancelar</a>
                    <button class='btn btn-primary'>Crear</button>
                </div>
            </form>
        </div>
    </div>
</div>